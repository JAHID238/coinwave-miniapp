<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CoinWave Mini App</title>
  <style>
    body { font-family: system-ui, Arial; margin:0; background:#f3f5fa; color:#111; }
    header { padding:16px; text-align:center; background:#0088cc; color:#fff; font-weight:600; font-size:20px; }
    .wrap { max-width:720px; margin:0 auto; padding:16px; }
    .card { background:#fff; border-radius:16px; padding:20px; box-shadow:0 4px 16px rgba(0,0,0,.08); margin:16px 0; }
    .btn { display:inline-block; padding:12px 20px; background:#0088cc; color:#fff; border-radius:10px; text-decoration:none; font-weight:600; transition:.2s; }
    .btn:hover { background:#006fa6; }
    .muted { color:#777; font-size:14px; }
    .balance { font-size:22px; font-weight:700; margin:10px 0; color:#0088cc; }
    .progress { background:#eee; border-radius:10px; overflow:hidden; height:12px; margin:8px 0; }
    .progress-bar { height:100%; background:#0088cc; width:0%; transition:.3s; }
    .task { padding:12px; border:1px solid #eee; border-radius:10px; margin:10px 0; }
    .task p { margin:0 0 8px; }
    .ad-box { min-height:90px; border:1px dashed #ccc; border-radius:10px; padding:8px; display:flex; align-items:center; justify-content:center; margin-top:10px; font-size:14px; color:#777; }
  </style>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <header>üíé CoinWave ‚Äî Mini App</header>

  <div class="wrap">
    <div class="card">
      <h2>üëã ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ</h2>
      <p class="muted">‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßã ‚Üí Ad ‡¶¶‡ßá‡¶ñ‡ßã ‚Üí Coins Claim ‡¶ï‡¶∞‡ßã ‚Üí ‡¶™‡¶∞‡ßá Cashout ‡¶ï‡¶∞‡ßã!</p>

      <div class="balance">Balance: <span id="coin-balance">0</span> ü™ô</div>
      <div class="progress"><div class="progress-bar" id="progress-bar"></div></div>
    </div>

    <div class="card">
      <h3>üî• Available Tasks</h3>

      <div class="task">
        <p>‚ñ∂ Watch Banner Ad (300x250)</p>
        <a href="#" class="btn claim-btn" data-coins="10" data-ad="banner-300x250">Claim 10 Coins</a>
        <div id="banner-300x250" class="ad-box">Ad will load here after click...</div>
      </div>

      <div class="task">
        <p>‚ñ∂ Watch Native Ad</p>
        <a href="#" class="btn claim-btn" data-coins="15" data-ad="native-banner">Claim 15 Coins</a>
        <div id="native-banner" class="ad-box">Ad will load here after click...</div>
      </div>
    </div>

    <div class="card">
      <h3>üë§ User Info</h3>
      <pre id="user"></pre>
    </div>
  </div>

  <script>
    const tg = window.Telegram?.WebApp;
    if (tg) {
      tg.expand();
      const u = tg.initDataUnsafe?.user || {};
      document.getElementById('user').textContent = JSON.stringify({
        id:u.id, username:u.username, first_name:u.first_name, lang:u.language_code
      }, null, 2);
    }

    let coins = 0;
    const coinBalance = document.getElementById('coin-balance');
    const progressBar = document.getElementById('progress-bar');

    document.querySelectorAll('.claim-btn').forEach(btn=>{
      btn.addEventListener('click', e=>{
        e.preventDefault();
        let amount = parseInt(btn.dataset.coins);
        let adId = btn.dataset.ad;
        const adBox = document.getElementById(adId);

        adBox.innerHTML = "‚è≥ Loading Ad...";

        // ===== Inject Ad Codes =====
        if(adId === "banner-300x250"){
          let s = document.createElement('script');
          s.type = "text/javascript";
          s.innerHTML = `
            atOptions = {
              'key' : '6928b0f5b1a27066c76882257e555423',
              'format' : 'iframe',
              'height' : 250,
              'width' : 300,
              'params' : {}
            };
          `;
          adBox.appendChild(s);
          let js = document.createElement('script');
          js.src = "//www.highperformanceformat.com/6928b0f5b1a27066c76882257e555423/invoke.js";
          adBox.appendChild(js);
        }

        if(adId === "native-banner"){
          let js = document.createElement('script');
          js.src = "//pl25115346.profitableratecpm.com/ca1b8379ef33060d43ac0c3db8e8035e/invoke.js";
          js.async = true;
          adBox.appendChild(js);
        }

        // ===== Delay Coins after Ad =====
        setTimeout(()=>{
          coins += amount;
          coinBalance.textContent = coins;
          progressBar.style.width = Math.min((coins/100)*100,100)+"%";
          alert("‚úÖ " + amount + " Coins Added!");
        }, 5000); // 5 sec wait for ad
      });
    });
  </script>
</body>
</html>
